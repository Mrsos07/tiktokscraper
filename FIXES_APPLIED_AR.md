# ุงูุชุญุณููุงุช ุงููุทุจูุฉ ุนูู ูุธุงู ุณุญุจ ูุญูุธ ุงูููุฏูููุงุช

## ุงูุชุงุฑูุฎ: 2025-10-09

---

## โ ุงููุดุงูู ุงูุชู ุชู ุฅุตูุงุญูุง

### 1. **ุชุนุฏูู ุญุฏ ุนุฏุฏ ุงูููุฏูููุงุช**
- **ูุจู**: ูุงู ุงูุญุฏ ูู 1 ุฅูู 200 ููุฏูู
- **ุจุนุฏ**: ุฃุตุจุญ ุงูุญุฏ ูู 1 ุฅูู 20 ููุฏูู ูุญุฏ ุฃูุตู
- **ุงููููุงุช ุงููุนุฏูุฉ**:
  - `app/models/schemas.py` - ุชู ุชุนุฏูู `JobCreate.limit` ู `ScheduledJobCreate.limit`
  - `.env.example` - ุชู ุชุนุฏูู `TIKTOK_MAX_VIDEOS_PER_REQUEST=20`

### 2. **ุชุญุณูู ุงุณุชุฎุฑุงุฌ ุฑุงุจุท ุงูููุฏูู**
- **ุงููุดููุฉ**: ูุงู ุงููุธุงู ููุดู ูู ุงุณุชุฎุฑุงุฌ ุฑุงุจุท ุงูููุฏูู ูู ุงูุจูุงูุงุช ุงููุณุญูุจุฉ
- **ุงูุญู**: 
  - ุฅุถุงูุฉ ูุนุงูุฌุฉ ูุชุนุฏุฏุฉ ุงููุณุชููุงุช ูุงุณุชุฎุฑุงุฌ ุงูุฑุงุจุท
  - ุงูุชุนุงูู ูุน ุญุงูุฉ ููู ุงูุฑุงุจุท ูุงููุณ (dictionary) ูููุณ ูุต
  - ุงูุจุญุซ ูู ุฃูุงูู ุจุฏููุฉ ูู ุงูุจูุงูุงุช
- **ุงูููู ุงููุนุฏู**: `app/scrapers/base_scraper.py`

### 3. **ุชุญุณูู ุขููุฉ ุงูุชุญููู ูุงูุญูุธ**
- **ุงูุชุญุณููุงุช**:
  - ุงูุชุญูู ูู ุตุญุฉ ุงูุฑุงุจุท ูุจู ุงูุชุญููู
  - ุงูุชุญูู ูู ููุน ุงููุญุชูู (Content-Type)
  - ุงูุชุฃูุฏ ูู ุญูุธ ุงูููู ุจูุฌุงุญ (ุญุฌู > 0)
  - ุงูุชุญูู ูู ูุฌูุฏ ุงูููู ุนูู ุงููุฑุต
  - ูุนุงูุฌุฉ ุฃุฎุทุงุก HTTP ุจุดูู ุฃูุถู
- **ุงูููู ุงููุนุฏู**: `app/downloaders/video_downloader.py`

### 4. **ุชุญุณูู ุงุณุชุฎุฑุงุฌ ุงูููุฏูู ูู ุงูุตูุญุฉ**
- **ุงูุชุญุณููุงุช**:
  - ุชุญููู JSON ูู script tags ูู ุงูุตูุญุฉ
  - ุงูุจุญุซ ูู `SIGI_STATE` ู `__UNIVERSAL_DATA_FOR_REHYDRATION__`
  - ุงุณุชุฎุฏุงู regex patterns ูุชุนุฏุฏุฉ ูุฎูุงุฑ ุงุญุชูุงุทู
  - ุชุณุฌูู ุฃูุถู ููุฃุฎุทุงุก
- **ุงูููู ุงููุนุฏู**: `app/downloaders/video_downloader.py`

### 5. **ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูู ูุนุงูุฌ ุงูููุงู**
- **ุงูุชุญุณููุงุช**:
  - ุฅุถุงูุฉ ุชุญุฐูุฑ ุนูุฏ ุนุฏู ูุฌูุฏ ุฑุงุจุท ููุฏูู
  - ุงูุชุญูู ูู ุญูุธ ุงูููู ุจุนุฏ ุงูุชุญููู
  - ุฑุณุงุฆู ุฎุทุฃ ุฃูุซุฑ ูุถูุญุงู
  - ุชุณุฌูู ุชูุตููู ููู ุฎุทูุฉ
- **ุงูููู ุงููุนุฏู**: `app/workers/job_processor.py`

---

## ๐ ูุง ูุฌุจ ุนููู ูุนูู ุงูุขู

### **ูุง ููุฌุฏ ุจูุงูุงุช ุฅุถุงููุฉ ูุทููุจุฉ ููู!**

ุงููุธุงู ุฌุงูุฒ ููุนูู. ููุท ุชุฃูุฏ ูู:

### 1. **ุฅุนุฏุงุฏ ููู `.env`**
ุฅุฐุง ูู ููู ููุฌูุฏุงูุ ุงูุณุฎ `.env.example` ุฅูู `.env`:
```bash
cp .env.example .env
```

### 2. **ุชุญุฏูุซ ุงูุจูุงูุงุช ูู `.env` (ุงุฎุชูุงุฑู)**
ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ููุฌูุฏุฉ ุจุงููุนูุ ููู ููููู ุชุฎุตูุต:

```env
# ูุณุงุฑ ุญูุธ ุงูููุฏูููุงุช ูุญููุงู
LOCAL_STORAGE_PATH=./downloads

# ุนุฏุฏ ุงูุชุญูููุงุช ุงููุชุฒุงููุฉ
MAX_CONCURRENT_DOWNLOADS=5

# ุฅุนุฏุงุฏุงุช Google Drive (ุฅุฐุง ุฃุฑุฏุช ุงูุฑูุน ุงูุชููุงุฆู)
GOOGLE_DRIVE_CREDENTIALS_FILE=./credentials/google_drive_credentials.json
GOOGLE_DRIVE_ROOT_FOLDER_ID=your-folder-id-here
```

### 3. **ุชุดุบูู ุงููุธุงู**
```bash
# ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
.\venv\Scripts\activate

# ุชุดุบูู ุงูุฎุงุฏู
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

---

## ๐ฏ ููููุฉ ุงูุงุณุชุฎุฏุงู

### **ูุซุงู 1: ุณุญุจ ููุฏูููุงุช ูู ุจุฑููุงูู**
```bash
curl -X POST "http://localhost:8000/api/jobs" \
  -H "Content-Type: application/json" \
  -d '{
    "mode": "profile",
    "value": "username",
    "limit": 10,
    "no_watermark": true
  }'
```

### **ูุซุงู 2: ุณุญุจ ููุฏูููุงุช ูู ูุงุดุชุงู**
```bash
curl -X POST "http://localhost:8000/api/jobs" \
  -H "Content-Type: application/json" \
  -d '{
    "mode": "hashtag",
    "value": "trending",
    "limit": 5,
    "no_watermark": true
  }'
```

### **ูุซุงู 3: ุงูุชุญูู ูู ุญุงูุฉ ุงููููุฉ**
```bash
curl "http://localhost:8000/api/jobs/{job_id}"
```

---

## ๐ ุขููุฉ ุนูู ุงููุธุงู ุงููุญุณููุฉ

### **1. ุงูุณุญุจ (Scraping)**
- ูููู ุจุณุญุจ ุงูุจูุงูุงุช ูู TikTok
- ูุณุชุฎุฑุฌ ูุนูููุงุช ุงูููุฏูู ุจูุง ูู ุฐูู ุงูุฑุงุจุท
- ูุญุงูู ุทุฑู ูุชุนุฏุฏุฉ ูุงุณุชุฎุฑุงุฌ ุงูุฑุงุจุท

### **2. ุงูุชุญููู (Downloading)**
- ูุชุญูู ูู ุตุญุฉ ุงูุฑุงุจุท
- ูุญูู ุงูููุฏูู ุจุทุฑู ูุชุนุฏุฏุฉ:
  - ูู ุงูุฑุงุจุท ุงููุจุงุดุฑ
  - ูู CDN ุจุฏูู ุนูุงูุฉ ูุงุฆูุฉ
  - ูู ุงูุตูุญุฉ ูุจุงุดุฑุฉ (fallback)
- ูุชุญูู ูู ูุฌุงุญ ุงูุญูุธ

### **3. ุงูุญูุธ (Saving)**
- ูุญูุธ ุงูููุฏูู ูู: `downloads/{mode}/{value}/{video_id}.mp4`
- ูุชุญูู ูู ูุฌูุฏ ุงูููู ูุญุฌูู
- ูุณุฌู ูุนูููุงุช ุงูููุฏูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### **4. ุงูุฑูุน (Upload) - ุงุฎุชูุงุฑู**
- ูุฑูุน ุฅูู Google Drive ุฅุฐุง ุชู ุฅุนุฏุงุฏู
- ููุธู ุงููููุงุช ูู ูุฌูุฏุงุช ุญุณุจ ุงูุชุงุฑูุฎ

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### **ุงููุดููุฉ: "No video URL found"**
**ุงูุญู**: 
- ุงููุธุงู ุณูุญุงูู ุงุณุชุฎุฑุงุฌ ุงูุฑุงุจุท ูู ุงูุตูุญุฉ ุชููุงุฆูุงู
- ุชุฃูุฏ ูู ุฃู `TIKTOK_USE_PLAYWRIGHT_FALLBACK=true`

### **ุงููุดููุฉ: "Download failed"**
**ุงูุญู**:
- ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช
- ุชุญูู ูู ุตูุงุญูุงุช ุงููุชุงุจุฉ ูู ูุฌูุฏ `downloads`
- ุฑุงุฌุน ููู ุงููููุงุช ููุชูุงุตูู

### **ุงููุดููุฉ: "File not saved or empty"**
**ุงูุญู**:
- ุชุฃูุฏ ูู ูุฌูุฏ ูุณุงุญุฉ ูุงููุฉ ุนูู ุงููุฑุต
- ุชุญูู ูู ุตูุงุญูุงุช ุงููุชุงุจุฉ
- ุฌุฑุจ ุชูููู `MAX_CONCURRENT_DOWNLOADS`

---

## ๐ ุงูุชุญุณููุงุช ุงูุฅุถุงููุฉ ุงูููุชุฑุญุฉ (ูุณุชูุจูุงู)

1. โ **ุฅุถุงูุฉ ูุงุฌูุฉ ูุณุชุฎุฏู (UI)** - ููุฌูุฏุฉ ุจุงููุนู ูู Streamlit
2. โก **ุชุญุณูู ุงูุณุฑุนุฉ** - ุงุณุชุฎุฏุงู Playwright ููุญุงูุงุช ุงูุตุนุจุฉ
3. ๐ **ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงูุชููุงุฆูุฉ** - ููุฌูุฏุฉ ุจุงููุนู (3 ูุญุงููุงุช)
4. ๐ **ุฅุญุตุงุฆูุงุช ููุตูุฉ** - ูุชููุฑุฉ ูู `/api/stats`

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุฑุงุฌุน ููู ุงููููุงุช ูู `logs/`
2. ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: `tiktok_scraper.db`
3. ุฌุฑุจ ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช: `python test_full_workflow.py`

---

## โจ ููุฎุต ุงูุชุบููุฑุงุช

| ุงูููุฒุฉ | ูุจู | ุจุนุฏ |
|--------|-----|-----|
| ุญุฏ ุงูููุฏูููุงุช | 1-200 | 1-20 |
| ุงุณุชุฎุฑุงุฌ ุงูุฑุงุจุท | ุทุฑููุฉ ูุงุญุฏุฉ | ุทุฑู ูุชุนุฏุฏุฉ |
| ุงูุชุญูู ูู ุงูุญูุธ | ูุง ููุฌุฏ | ุชุญูู ูุงูู |
| ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก | ุฃุณุงุณูุฉ | ูุชูุฏูุฉ |
| ุงูุชุณุฌูู | ูุญุฏูุฏ | ุชูุตููู |

---

**ุชู ุงูุชุญุฏูุซ ุจูุฌุงุญ! ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ๐**
